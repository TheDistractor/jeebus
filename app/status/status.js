(function() {
  var ng, statusCtrl;

  ng = angular.module('myApp');

  ng.config(function($stateProvider, navbarProvider) {
    $stateProvider.state('status', {
      url: '/status',
      templateUrl: 'status/status.html',
      controller: statusCtrl
    });
    return navbarProvider.add('/status', 'Status', 30);
  });

  statusCtrl = function($scope, jeebus) {
    var adjust, drivers, rowHandler, setup;
    drivers = {};
    rowHandler = function(key, row) {
      var id, loc, ms, param, raw, typ, val, _results;
      loc = row.loc, ms = row.ms, val = row.val, typ = row.typ;
      _results = [];
      for (param in val) {
        raw = val[param];
        id = "" + key + " - " + param;
        _results.push(this.put(id, adjust({
          loc: loc,
          param: param,
          raw: raw,
          ms: ms,
          typ: typ
        })));
      }
      return _results;
    };
    adjust = function(row) {
      var info;
      row.value = row.raw;
      info = drivers.get("" + row.typ + "/" + row.param);
      if (info != null) {
        row.param = info.name;
        row.unit = info.unit;
        if (info.factor) {
          row.value *= info.factor;
        }
        if (info.scale < 0) {
          row.value *= Math.pow(10, -info.scale);
        } else if (info.scale >= 0) {
          row.value /= Math.pow(10, info.scale);
          row.value = row.value.toFixed(info.scale);
        }
      }
      return row;
    };
    setup = function() {
      return drivers = jeebus.attach('driver').on('sync', function() {
        return jeebus.attach('sensor', rowHandler).on('init', function() {
          return $scope.readings = this.rows;
        });
      });
    };
    if ($scope.serverStatus === 'connected') {
      setup();
    }
    return $scope.$on('ws-open', setup);
  };

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsic3RhdHVzLmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUFBLE1BQUEsY0FBQTs7QUFBQSxFQUFBLEVBQUEsR0FBSyxPQUFPLENBQUMsTUFBUixDQUFlLE9BQWYsQ0FBTCxDQUFBOztBQUFBLEVBRUEsRUFBRSxDQUFDLE1BQUgsQ0FBVSxTQUFDLGNBQUQsRUFBaUIsY0FBakIsR0FBQTtBQUNSLElBQUEsY0FBYyxDQUFDLEtBQWYsQ0FBcUIsUUFBckIsRUFDRTtBQUFBLE1BQUEsR0FBQSxFQUFLLFNBQUw7QUFBQSxNQUNBLFdBQUEsRUFBYSxvQkFEYjtBQUFBLE1BRUEsVUFBQSxFQUFZLFVBRlo7S0FERixDQUFBLENBQUE7V0FJQSxjQUFjLENBQUMsR0FBZixDQUFtQixTQUFuQixFQUE4QixRQUE5QixFQUF3QyxFQUF4QyxFQUxRO0VBQUEsQ0FBVixDQUZBLENBQUE7O0FBQUEsRUFTQSxVQUFBLEdBQWEsU0FBQyxNQUFELEVBQVMsTUFBVCxHQUFBO0FBQ1gsUUFBQSxrQ0FBQTtBQUFBLElBQUEsT0FBQSxHQUFVLEVBQVYsQ0FBQTtBQUFBLElBRUEsVUFBQSxHQUFhLFNBQUMsR0FBRCxFQUFNLEdBQU4sR0FBQTtBQUVYLFVBQUEsMkNBQUE7QUFBQSxNQUFDLFVBQUEsR0FBRCxFQUFLLFNBQUEsRUFBTCxFQUFRLFVBQUEsR0FBUixFQUFZLFVBQUEsR0FBWixDQUFBO0FBQ0E7V0FBQSxZQUFBO3lCQUFBO0FBQ0UsUUFBQSxFQUFBLEdBQUssRUFBQSxHQUFFLEdBQUYsR0FBTyxLQUFQLEdBQVcsS0FBaEIsQ0FBQTtBQUFBLHNCQUNBLElBQUMsQ0FBQSxHQUFELENBQUssRUFBTCxFQUFTLE1BQUEsQ0FBTztBQUFBLFVBQUMsS0FBQSxHQUFEO0FBQUEsVUFBSyxPQUFBLEtBQUw7QUFBQSxVQUFXLEtBQUEsR0FBWDtBQUFBLFVBQWUsSUFBQSxFQUFmO0FBQUEsVUFBa0IsS0FBQSxHQUFsQjtTQUFQLENBQVQsRUFEQSxDQURGO0FBQUE7c0JBSFc7SUFBQSxDQUZiLENBQUE7QUFBQSxJQVNBLE1BQUEsR0FBUyxTQUFDLEdBQUQsR0FBQTtBQUNQLFVBQUEsSUFBQTtBQUFBLE1BQUEsR0FBRyxDQUFDLEtBQUosR0FBWSxHQUFHLENBQUMsR0FBaEIsQ0FBQTtBQUFBLE1BQ0EsSUFBQSxHQUFPLE9BQU8sQ0FBQyxHQUFSLENBQVksRUFBQSxHQUFFLEdBQUcsQ0FBQyxHQUFOLEdBQVcsR0FBWCxHQUFhLEdBQUcsQ0FBQyxLQUE3QixDQURQLENBQUE7QUFFQSxNQUFBLElBQUcsWUFBSDtBQUNFLFFBQUEsR0FBRyxDQUFDLEtBQUosR0FBWSxJQUFJLENBQUMsSUFBakIsQ0FBQTtBQUFBLFFBQ0EsR0FBRyxDQUFDLElBQUosR0FBVyxJQUFJLENBQUMsSUFEaEIsQ0FBQTtBQUdBLFFBQUEsSUFBRyxJQUFJLENBQUMsTUFBUjtBQUNFLFVBQUEsR0FBRyxDQUFDLEtBQUosSUFBYSxJQUFJLENBQUMsTUFBbEIsQ0FERjtTQUhBO0FBS0EsUUFBQSxJQUFHLElBQUksQ0FBQyxLQUFMLEdBQWEsQ0FBaEI7QUFDRSxVQUFBLEdBQUcsQ0FBQyxLQUFKLElBQWEsSUFBSSxDQUFDLEdBQUwsQ0FBUyxFQUFULEVBQWEsQ0FBQSxJQUFLLENBQUMsS0FBbkIsQ0FBYixDQURGO1NBQUEsTUFFSyxJQUFHLElBQUksQ0FBQyxLQUFMLElBQWMsQ0FBakI7QUFDSCxVQUFBLEdBQUcsQ0FBQyxLQUFKLElBQWEsSUFBSSxDQUFDLEdBQUwsQ0FBUyxFQUFULEVBQWEsSUFBSSxDQUFDLEtBQWxCLENBQWIsQ0FBQTtBQUFBLFVBQ0EsR0FBRyxDQUFDLEtBQUosR0FBWSxHQUFHLENBQUMsS0FBSyxDQUFDLE9BQVYsQ0FBa0IsSUFBSSxDQUFDLEtBQXZCLENBRFosQ0FERztTQVJQO09BRkE7YUFhQSxJQWRPO0lBQUEsQ0FUVCxDQUFBO0FBQUEsSUF5QkEsS0FBQSxHQUFRLFNBQUEsR0FBQTthQUNOLE9BQUEsR0FBVSxNQUFNLENBQUMsTUFBUCxDQUFjLFFBQWQsQ0FDUixDQUFDLEVBRE8sQ0FDSixNQURJLEVBQ0ksU0FBQSxHQUFBO2VBQ1YsTUFBTSxDQUFDLE1BQVAsQ0FBYyxRQUFkLEVBQXdCLFVBQXhCLENBQ0UsQ0FBQyxFQURILENBQ00sTUFETixFQUNjLFNBQUEsR0FBQTtpQkFDVixNQUFNLENBQUMsUUFBUCxHQUFrQixJQUFDLENBQUEsS0FEVDtRQUFBLENBRGQsRUFEVTtNQUFBLENBREosRUFESjtJQUFBLENBekJSLENBQUE7QUFnQ0EsSUFBQSxJQUFZLE1BQU0sQ0FBQyxZQUFQLEtBQXVCLFdBQW5DO0FBQUEsTUFBQSxLQUFBLENBQUEsQ0FBQSxDQUFBO0tBaENBO1dBaUNBLE1BQU0sQ0FBQyxHQUFQLENBQVcsU0FBWCxFQUFzQixLQUF0QixFQWxDVztFQUFBLENBVGIsQ0FBQTtBQUFBIiwic291cmNlc0NvbnRlbnQiOlsibmcgPSBhbmd1bGFyLm1vZHVsZSAnbXlBcHAnXG5cbm5nLmNvbmZpZyAoJHN0YXRlUHJvdmlkZXIsIG5hdmJhclByb3ZpZGVyKSAtPlxuICAkc3RhdGVQcm92aWRlci5zdGF0ZSAnc3RhdHVzJyxcbiAgICB1cmw6ICcvc3RhdHVzJ1xuICAgIHRlbXBsYXRlVXJsOiAnc3RhdHVzL3N0YXR1cy5odG1sJ1xuICAgIGNvbnRyb2xsZXI6IHN0YXR1c0N0cmxcbiAgbmF2YmFyUHJvdmlkZXIuYWRkICcvc3RhdHVzJywgJ1N0YXR1cycsIDMwXG5cbnN0YXR1c0N0cmwgPSAoJHNjb3BlLCBqZWVidXMpIC0+XG4gIGRyaXZlcnMgPSB7fVxuICBcbiAgcm93SGFuZGxlciA9IChrZXksIHJvdykgLT5cbiAgICAjIGxvYzogLi4uIHZhbDogW2MxOjEyLGMyOjM0LC4uLl1cbiAgICB7bG9jLG1zLHZhbCx0eXB9ID0gcm93XG4gICAgZm9yIHBhcmFtLCByYXcgb2YgdmFsXG4gICAgICBpZCA9IFwiI3trZXl9IC0gI3twYXJhbX1cIiAjIGRldmljZSBpZFxuICAgICAgQHB1dCBpZCwgYWRqdXN0IHtsb2MscGFyYW0scmF3LG1zLHR5cH1cblxuICBhZGp1c3QgPSAocm93KSAtPlxuICAgIHJvdy52YWx1ZSA9IHJvdy5yYXdcbiAgICBpbmZvID0gZHJpdmVycy5nZXQgXCIje3Jvdy50eXB9LyN7cm93LnBhcmFtfVwiXG4gICAgaWYgaW5mbz9cbiAgICAgIHJvdy5wYXJhbSA9IGluZm8ubmFtZVxuICAgICAgcm93LnVuaXQgPSBpbmZvLnVuaXRcbiAgICAgICMgYXBwbHkgc29tZSBzY2FsaW5nIGFuZCBmb3JtYXR0aW5nXG4gICAgICBpZiBpbmZvLmZhY3RvclxuICAgICAgICByb3cudmFsdWUgKj0gaW5mby5mYWN0b3JcbiAgICAgIGlmIGluZm8uc2NhbGUgPCAwXG4gICAgICAgIHJvdy52YWx1ZSAqPSBNYXRoLnBvdyAxMCwgLWluZm8uc2NhbGVcbiAgICAgIGVsc2UgaWYgaW5mby5zY2FsZSA+PSAwXG4gICAgICAgIHJvdy52YWx1ZSAvPSBNYXRoLnBvdyAxMCwgaW5mby5zY2FsZVxuICAgICAgICByb3cudmFsdWUgPSByb3cudmFsdWUudG9GaXhlZCBpbmZvLnNjYWxlXG4gICAgcm93XG5cbiAgc2V0dXAgPSAtPlxuICAgIGRyaXZlcnMgPSBqZWVidXMuYXR0YWNoICdkcml2ZXInXG4gICAgICAub24gJ3N5bmMnLCAtPlxuICAgICAgICBqZWVidXMuYXR0YWNoICdzZW5zb3InLCByb3dIYW5kbGVyXG4gICAgICAgICAgLm9uICdpbml0JywgLT5cbiAgICAgICAgICAgICRzY29wZS5yZWFkaW5ncyA9IEByb3dzXG4gICAgICBcbiAgc2V0dXAoKSAgaWYgJHNjb3BlLnNlcnZlclN0YXR1cyBpcyAnY29ubmVjdGVkJ1xuICAkc2NvcGUuJG9uICd3cy1vcGVuJywgc2V0dXBcbiJdfQ==
